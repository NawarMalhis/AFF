# Annotated Fasta Format (AFF)

The Annotated FASTA Format (AFF), with a .af file extension, is a text-based format for protein amino acid sequences that includes multiple annotation tags and a statistical summary header. This AFF Python library provides tools for reading, writing, and processing .af files, as well as reading residue-level scores, generating ROC and precision-recall plots, and calculating metrics such as AUC, average precision score (APS), and success rate.

AFF files are divided into two sections, the header section and the data section. See the AFF sample file below.

### AFF sample file
```bash
# Data Name: A sample annotated FASTA format file
#
# Optional top comments line 1
# Optional top comments line 2
#
# Sequences: 34
#
# Format:
# >accession|DisProt=DisProt_ID|UniProt=UniProt_ID|OX=OX_ID|Pfam=Pfam_ID|IDEAL=IDEAL_ID|PDB=PDB_ID|AlphaFoldDB=AlphaFoldDB_ID|ELM=ELM_ID
# Amino acid sequence
# IDR  Protein disordered region
# DtO  Disordered to ordered transition
# Linker  Linker regions
# binding  IDR binding in general
# binding_protein  IDR-binding to proteins
# binding_nucleic  IDR-binding to nucleic
# binding_ion  IDR-binding to ions
# binding_lipid  IDR-binding to lipids
# binding_SM  IDR binding to small molecules
#
# ID Counts:
#   ID   Seq#   Total#  Unique#
#   DisProt  34  34   34
#   UniProt  34  137  137
#   OX  34  141  99
#   Pfam  33  58  56
#   IDEAL  8  8  8
#   PDB  29  509  509
#   AlphaFoldDB  31  95  95
#   ELM  4  4  4
#
# Tags Counts:
#   tag  Seq# Seg#  '0' '1'  '-'
#   IDR  34  44  8,016  4,247  11
#   DtO  12  16  1,803  775  0
#   Linker  6  6  1,381  93  0
#   binding  18  19  3,588  2,534  0
#   binding_protein  13  14  2,674  2,138  0
#   binding_nucleic  3  3  44  240  0
#   binding_ion  0  0  0  0  0
#   binding_lipid  3  3  551  361  0
#   binding_SM  1  1  319  9  0
#
>DP00004|DisProt=DP00004|UniProt=P49913;A0A384NPR0|OX=9606;9606|PDB=7PDC;5NMN;2FBS;2FCG;6BIX;5NNM;2LMF;4EYC;5NNK;6BIV;7SAY;8DEW;6S6M;2FBU;5XNG;2NA3;2K6O;5NNT;7NPQ;5XRX|AlphaFoldDB=A0A384NPR0;P49913|Pfam=PF12153;PF00666
MKTQRDGHSLGRWSLVLLLLGLVMPLAIIAQVLSYKEAVLRAIDGINQRSSDANLYRLLDLDPRPTMDGDPDTPKPVSFTVKETVCPRTTQQSPEDCDFKKDGLVKRCMGTVTLNQARGSFDISCDKDNKRFALLGDFFRKSKEKIGKEFKRIVQRIKDFLRNLVPRTES
-----------000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111111111
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
>DP00005|DisProt=DP00005|UniProt=P03045;A0A0L6XR33;A0A9X0F6B5;A0A4Q1A3T8;A0A246E3T6;Q38265;A0A619L6W2;A0A657F2Z0;A0A627WVL0;A0A1C0UMS0|OX=1313;90371;149539;28901;2681611;10710;2002831;1235825;562;10710;2044509|PDB=1QFQ;5LM7;5MS0;6GOV|Pfam=PF11438|AlphaFoldDB=A0A0L6XR33;A0A4Q1A3T8;A0A246E3T6;A0A619L6W2;A0A657F2Z0;A0A627WVL0;A0A1C0UMS0
MDAQTRRRERRAEKQAQWKAANPLLVGVSAKPVNRPILSLNRKPKSRVESALNPIDLTVLAEYHKQIESNLQRIERKNQRTWYSKPGERGITCSGRQKIKGKSIPLI
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
>DP00006|DisProt=DP00006|UniProt=P00004;K9KAT1|OX=9796;9796|PDB=3O20;2PCB;1LC2;6SUV;5WVE;1FI7;3WUI;1GIW;1CRC;1WEJ;5ZKV;1OCD;3WC8;4NFG;1I5T;1AKK;2FRC;2N3B;3O1Y;2GIW;6K9J;8ZXR;3NBT;1M60;4RSZ;5IY5;6K9I;1FI9;1U75;1HRC;1LC1;3NBS;3JBT|AlphaFoldDB=K9KAT1;P00004|Pfam=PF00034
MGDVEKGKKIFVQKCAQCHTVEKGGKHKTGPNLHGLFGRKTGQAPGFTYTDANKNKGITWKEETLMEYLENPKKYIPGTKMIFAGIKKKTEREDLIAYLKKATNE
011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110
000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

... more data
```
## The header section
The header section outlines the format of the data annotation and provides some statistical information about these annotations. Lines in the header start with the ‘#’ character, indicating non-data lines.
The header is divided into seven parts.
1.	Data name
2.	Optional top comments
3.	Sequence count.
4.	**Data annotation format:** See below.
5.	**ID counts:** See below.
6.	**Tag counts:** See below.
7.	Optional bottom comments

The **AFF (Data annotation format)** defines the structure for representing a single annotated protein sequence and consists of three main components:
- **Header Line:** Starts with a '>' character, followed by the sequence accession and one or more identifier phrases often referencing specialized databases separated by '|'. Each identifier phrase consists of the identifier source, the '=' character, and a list of IDs separated by ';'. If the AFF was created from a simple AFF or a FASTA file, the first identifier phrase with the source 'FASTA' refers to the identifier used by the original fasta file, which is usually the accession.
- **Amino Acid Sequence:** Provided on the line immediately following the header. It uses one-letter amino acid codes (e.g., A, R, N, D) and is limited to a single line.
- **Annotation Line(s):** One or more lines follow the amino acid sequence, each corresponding to a specific feature or **TAG**. These lines must be the same length as the amino acid sequence, with each character aligned to a residue. Standard annotation characters include '0' (feature absent), '1' (feature present), and '-' (unknown). Additional user-defined characters can also be used to represent other annotations.

The **ID counts:** count all identifier phrases used. In the above AFF file example, 33 out of the 34 total sequences have Pfam IDs, totaling 58 Pfam IDs, including 56 unique IDs.

The **Tag counts:** count the three standard annotation characters '0' (feature absent), '1' (feature present), and '-' (unknown) for each annotation TAG.

## The data section


## Data structure


```bash

```
                                     
More details soon.



